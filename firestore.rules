service cloud.firestore {
  match /databases/{database}/documents {
    allow read, write: if true
    
  function isSignedIn() {
    return (request.auth.uid != null)
  }

  function userIsAdmin() {
    return request.auth.token.role == 'admin'
  }

  function userBelongsToCompany() {
    return request.auth.token.companyId == resource.data.companyId
  }

  function userAndAdmin() {
    return isSignedIn() && userIsAdmin()
  }

  function companyAdmin() {
    return userAndAdmin() && userBelongsToCompany()
  }

  function adminOrEmployee() {
    return userBelongsToCompany() && (userIsAdmin() || resource.data.id == request.auth.uid)
  }

  function adminOrOwner() {
    return userBelongsToCompany() && (userIsAdmin() || resource.data.employeeId == request.auth.uid)
  }

  function notCreator() {
    return resource.data.status != 'creator'
  }
}
